<!-- resources/templates/restaurantList.html -->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant List</title>
</head>
<body>
<h1>Restaurant List</h1>

<!-- 추가된 부분 -->
<form th:action="@{/restaurants/search}" method="get">
    <label for="category">Category:</label>
    <input type="text" id="category" name="category" required>

    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required>

    <button type="submit">Search</button>
</form>
<!-- 끝 -->

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Restaurant Name</th>
        <th>Category</th>
        <th>Address</th>
        <th>Restaurant Number</th>
        <th>Menu</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="restaurant : ${restaurants}">
        <td th:text="${restaurant.id}"></td>
        <td th:text="${restaurant.restaurantName}"></td>
        <td th:text="${restaurant.category}"></td>
        <td th:text="${restaurant.address}"></td>
        <td th:text="${restaurant.resNumber}"></td>
        <td>
            <ul>
                <li th:each="menu : ${restaurant.menu}">
                    <span th:text="${menu.foodName}"></span>
                </li>
            </ul>
        </td>
        <td>
            <a th:href="@{/restaurants/{id}(id=${restaurant.id})}">View</a>

            <a href="#" th:onclick="'deleteRestaurant(' + ${restaurant.id} + '); return false;'">Delete</a>
            <script>
                function deleteRestaurant(restaurantId) {
                    if (confirm('Are you sure?')) {
                        fetch(`/restaurants/${restaurantId}/delete`, {
                            method: 'DELETE'
                        })
                            .then(response => {
                                if (response.ok) {
                                    alert('Restaurant deleted successfully');
                                    // 여기서 추가적인 처리 또는 페이지 새로고침 등을 할 수 있습니다.
                                } else {
                                    alert('Cannot delete restaurant');
                                }
                            })
                            .catch(error => {
                                console.error('Error deleting restaurant:', error);
                                alert('Error deleting restaurant');
                            });
                    }
                }
            </script>
            <!-- 추가된 부분 -->
            <a th:href="@{/restaurant/{id}(id=${restaurant.id})}">Add Menu</a>

            <!-- 끝 -->
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>